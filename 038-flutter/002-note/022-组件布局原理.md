Measure、Layout、Draw

android https://medium.com/@britt.barak/measure-layout-draw-483c6a4d2fab
flutter 
web

常用布局容器的布局方式

代码示例



# 通用组件布局原理

## 1. 学习的内容和目的

- 了解布局的过程
- 了解常用组件的布局计算方式
- 避免布局计算中的错误
- 自定义组件

## 布局过程

布局三大流程：Measure，Layout，Paint

- Measure：计算View的Size
- Layout：Layout确定View的相对位置
- Paint：生成绘制命令

### Measure

- 这是一个自上而下递归的过程
- 分为水平和垂直两个维度
- 父级向自己传递限制
  - UNSPECIFIED：没有大小限制，例如无线滚动列表
  - EXACTLY：指定的高度或宽度
  - AT MOST：最大高度或宽度，例如Align
- 子级根据收到的限制和自身的`LayoutParams`确定自身的Size
  - An exact number：指定的高度或宽度，例如指定宽度的图片、文子段落
  - MATCH_PARENT：和父级一样大，沾满父级的空间，例如Align
  - WRAP_CONTENT：有View的内容来决定View的Size，例如Pading
  - 分为两种情况
    - 叶子节点：递归终止，并且得到了节点的Size
    - 容器节点：等待孩子节点计算出Size后，在计算出自身的Size

### Layout

- 确定子节点的位置
- 这也是一个之上而下递归的过程
- 容器节点更具子节点的Size确定子节点相对父节点的偏移量

### Draw

- 根据Size和Position生成Open-gl命令

### 关于动画

如果节点的属性值发生变化：

- 不改变布局：通知系统触发Draw过程，例如gif、weba
- 如果需要改变布局：重新触发Measure、Layout、Draw，例如路由动画

## 2. 举例：FlexBox的布局过程

- 可使用的属性
  - direction：水平|垂直
  - MainAxisAlignment：Start|End|Center|spaceBetween
  - MainAxisSize：Max|Min
  - CrossAxisAlignment：Start|End|Center

## 3. 自定制布局

双栏列表